{% extends 'todos/base.html' %}

{% block title %}Todo List - All Tasks{% endblock %}

{% block content %}
<div class="task-container">
    <div class="header-actions">
        <h2>My Tasks</h2>
        <a href="{% url 'task_create' %}" class="btn btn-primary">+ Add New Task</a>
    </div>

    {% if tasks %}
        <div class="task-stats">
            <span class="stat">Total: {{ tasks.count }}</span>
            <span class="stat">Completed: {{ tasks|dictsort:"completed"|slice:"-1:"|length }}</span>
            <span class="stat">Pending: {{ tasks|length|add:"-1" }}</span>
        </div>

        <div class="task-list">
            {% for task in tasks %}
            <div class="task-item {% if task.completed %}completed{% endif %}">
                <div class="task-content">
                    <form method="post" action="{% url 'task_toggle' task.pk %}" class="task-checkbox-form">
                        {% csrf_token %}
                        <input type="checkbox" 
                               id="task-{{ task.id }}" 
                               {% if task.completed %}checked{% endif %}
                               onchange="this.form.submit()">
                        <label for="task-{{ task.id }}"></label>
                    </form>
                    
                    <div class="task-details">
                        <h3>{{ task.title }}</h3>
                        {% if task.description %}
                        <p class="task-description">{{ task.description }}</p>
                        {% endif %}
                        <span class="task-date">Created: {{ task.created_at|date:"M d, Y" }}</span>
                    </div>
                </div>
                
                <div class="task-actions">
                    <a href="{% url 'task_update' task.pk %}" class="btn btn-secondary">Edit</a>
                    <form method="post" action="{% url 'task_delete' task.pk %}" class="delete-form" onsubmit="return confirm('Are you sure you want to delete this task?');">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger">Delete</button>
                    </form>
                </div>
            </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="empty-state">
            <div class="empty-icon">ðŸ“‹</div>
            <h3>No tasks yet</h3>
            <p>Start by creating your first task!</p>
            <a href="{% url 'task_create' %}" class="btn btn-primary">Create Task</a>
        </div>
    {% endif %}
</div>
{% endblock %}

